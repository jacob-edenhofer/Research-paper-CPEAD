group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median"))
corp_str1_1 <- oecd_stringency1 %>%
group_by(ref_area, time_period) %>%
mutate(obs_value1_cy = mean(obs_value1, na.rm = T)) %>%
ungroup() %>%
distinct(ref_area, time_period, obs_value1_cy, .keep_all = T) %>%
select(-c(clim_act_pol, climate_actions_and_policies)) %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median"))
str_balance_df <- corp_str1_1 %>%
select(obs_value1, corp_all_group) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
## merge into one dataframe
balance_df <- bind_rows(adopt_balance_df, str_balance_df)
adopt_balance_df <- corp_adopt1_1 %>%
select(obs_value1, corp_all_group, nv_ind_manf_zs, nv_ind_totl_zs, co2_per_capita,
trade_co2_share, openc, dis_gall, fossil_share_elec, fossil_share_energy) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
str_balance_df <- corp_str1_1 %>%
select(obs_value1, corp_all_group) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
## merge into one dataframe
balance_df <- bind_rows(adopt_balance_df, str_balance_df)
View(balance_df)
corp_adopt1_1 <- oecd_adoption1 %>%
group_by(ref_area, time_period) %>%
mutate(obs_value1_cy = mean(obs_value1, na.rm = T)) %>%
ungroup() %>%
distinct(ref_area, time_period, obs_value1_cy, .keep_all = T) %>%
select(-c(clim_act_pol, climate_actions_and_policies)) %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all < median_corp_all, "Below median", "Above median"))
adopt_balance_df <- corp_adopt1_1 %>%
select(obs_value1, corp_all_group, nv_ind_manf_zs, nv_ind_totl_zs, co2_per_capita,
trade_co2_share, openc, dis_gall, fossil_share_elec, fossil_share_energy) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
corp_str1_1 <- oecd_stringency1 %>%
group_by(ref_area, time_period) %>%
mutate(obs_value1_cy = mean(obs_value1, na.rm = T)) %>%
ungroup() %>%
distinct(ref_area, time_period, obs_value1_cy, .keep_all = T) %>%
select(-c(clim_act_pol, climate_actions_and_policies)) %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all < median_corp_all, "Below median", "Above median"))
str_balance_df <- corp_str1_1 %>%
select(obs_value1, corp_all_group) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
## merge into one dataframe
balance_df <- bind_rows(adopt_balance_df, str_balance_df)
View(balance_df)
corp_str1_1 <- oecd_stringency1 %>%
group_by(ref_area, time_period) %>%
mutate(obs_value1_cy = mean(obs_value1, na.rm = T)) %>%
ungroup() %>%
distinct(ref_area, time_period, obs_value1_cy, .keep_all = T) %>%
select(-c(clim_act_pol, climate_actions_and_policies)) %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all < median_corp_all, "Below median", "Above median"))
adopt_balance_df <- corp_adopt1_1 %>%
select(obs_value1, corp_all_group, nv_ind_manf_zs, nv_ind_totl_zs, co2_per_capita,
trade_co2_share, openc, dis_gall, fossil_share_elec, fossil_share_energy) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
str_balance_df <- corp_str1_1 %>%
select(obs_value1, corp_all_group) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
## merge into one dataframe
balance_df <- bind_rows(adopt_balance_df, str_balance_df)
View(balance_df)
View(adopt_balance_df)
corp_adopt1_1 <- oecd_adoption1 %>%
group_by(ref_area, time_period) %>%
mutate(obs_value1_cy = mean(obs_value1, na.rm = T)) %>%
ungroup() %>%
distinct(ref_area, time_period, obs_value1_cy, .keep_all = T) %>%
select(-c(clim_act_pol, climate_actions_and_policies)) %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all < median_corp_all, "Below median", "Above median"))
adopt_balance_df <- corp_adopt1_1 %>%
select(obs_value1, corp_all_group, nv_ind_manf_zs, nv_ind_totl_zs, co2_per_capita,
trade_co2_share, openc, dis_gall, fossil_share_elec, fossil_share_energy) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
View(adopt_balance_df)
corp_adopt1_1 <- oecd_adoption1 %>%
group_by(ref_area, time_period) %>%
mutate(obs_value1_cy = mean(obs_value1, na.rm = T)) %>%
ungroup() %>%
distinct(ref_area, time_period, obs_value1_cy, .keep_all = T) %>%
select(-c(clim_act_pol, climate_actions_and_policies)) %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median"))
adopt_balance_df <- corp_adopt1_1 %>%
select(obs_value1, corp_all_group, nv_ind_manf_zs, nv_ind_totl_zs, co2_per_capita,
trade_co2_share, openc, dis_gall, fossil_share_elec, fossil_share_energy) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
adopt_balance_df
View(corp_str1_1)
str_balance_df <- corp_str1_1 %>%
select("Stringency" = obs_value1_cy,
corp_all_group) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
View(str_balance_df)
corp_adopt1_1 <- oecd_adoption1 %>%
group_by(ref_area, time_period) %>%
mutate(obs_value1_cy = mean(obs_value1, na.rm = T)) %>%
ungroup() %>%
distinct(ref_area, time_period, obs_value1_cy, .keep_all = T) %>%
select(-c(clim_act_pol, climate_actions_and_policies)) %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median"))
adopt_balance_df <- corp_adopt1_1 %>%
select("Number of adopted policies" = obs_value1_cy,
corp_all_group, nv_ind_manf_zs, nv_ind_totl_zs, co2_per_capita,
trade_co2_share, openc, dis_gall, fossil_share_elec, fossil_share_energy) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
View(adopt_balance_df)
## merge into one dataframe
balance_df <- bind_rows(adopt_balance_df, str_balance_df)
View(adopt_balance_df)
adopt_balance_df <- corp_adopt1_1 %>%
select("Number of adopted policies" = obs_value1_cy,
corp_all_group,
"Manufacturing value added (% of GDP)" = nv_ind_manf_zs,
"Industry value added (% of GDP)" = nv_ind_totl_zs,
"CO2 emissions per capita" = co2_per_capita,
"Fossil share electricity" = fossil_share_elec,
"Fossil share energy" = fossil_share_energy,
"Trade CO2 share" = trade_co2_share,
"Openness of economy" = openc,
"Gallagher's disproportionality index" = dis_gall) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
### do the same for stringency
corp_str1_1 <- oecd_stringency1 %>%
group_by(ref_area, time_period) %>%
mutate(obs_value1_cy = mean(obs_value1, na.rm = T)) %>%
ungroup() %>%
distinct(ref_area, time_period, obs_value1_cy, .keep_all = T) %>%
select(-c(clim_act_pol, climate_actions_and_policies)) %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median"))
str_balance_df <- corp_str1_1 %>%
select("Stringency" = obs_value1_cy,
corp_all_group) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
## merge into one dataframe
balance_df <- bind_rows(adopt_balance_df, str_balance_df)
View(balance_df)
### use kableExtra to create a table
balance_df %>%
kable(format = "latex",
booktabs = T,
col.names = c("Variable", "Mean", "Std.Dev.", "Mean", "Std.Dev", "Diff in mean", "p.value")) %>%
kable_styling(latex_options = "hold_position") %>%
add_header_above(c(" ", "Adoption", " ", " ", " ", "Stringency", " ")) %>%
column_spec(1, bold = T) %>%
save_kable(here("06 Figures and tables", "Tables", "balance_table_motivation.tex"))
### use kableExtra to create a table
balance_df %>%
kable(format = "latex", escape = T,
booktabs = T,
col.names = c("Variable", "Mean", "Std.Dev.", "Mean", "Std.Dev", "Diff in mean", "p.value")) %>%
kable_styling(latex_options = "hold_position") %>%
add_header_above(c(" ", "Adoption", " ", " ", " ", "Stringency", " ")) %>%
column_spec(1, bold = T) %>%
save_kable(here("06 Figures and tables", "Tables", "balance_table_motivation.tex"))
### use kableExtra to create a table
balance_df %>%
kable(format = "latex", escape = T,
booktabs = T,
col.names = c("Variable", "Mean", "Std.Dev.", "Mean", "Std.Dev", "Diff in mean", "p.value")) %>%
kable_styling(latex_options = "hold_position") %>%
add_header_above(c(" ", "Adoption" = 2, "Stringency" = 2, " ", " ")) %>%
save_kable(here("06 Figures and tables", "Tables", "balance_table_motivation.tex"))
View(balance_df)
### use kableExtra to create a table
balance_df %>%
kable(format = "latex", escape = T,
booktabs = T,
col.names = c("Variable", "Mean", "Std.Dev.", "Mean", "Std.Dev", "Diff in mean", "p.value")) %>%
kable_styling(latex_options = "hold_position") %>%
add_header_above(c(" ", "Corporatism score" = 4, " ", " ")) %>%
add_header_above(c(" ", "Above median" = 2, "Below median" = 2, " ", " ")) %>%
save_kable(here("06 Figures and tables", "Tables", "balance_table_motivation.tex"))
### use kableExtra to create a table
balance_df %>%
kable(format = "latex", escape = T,
booktabs = T,
col.names = c("Variable", "Mean", "Std.Dev.", "Mean", "Std.Dev", "Diff in mean", "p.value")) %>%
kable_styling(latex_options = c("hold_position", "scale_down")) %>%
add_header_above(c(" ", "Corporatism score" = 4, " ", " ")) %>%
add_header_above(c(" ", "Above median" = 2, "Below median" = 2, " ", " ")) %>%
save_kable(here("06 Figures and tables", "Tables", "balance_table_motivation.tex"))
### use kableExtra to create a table
balance_df %>%
kable(format = "latex", escape = T,
booktabs = T,
col.names = c("Variable", "Mean", "Std.Dev.", "Mean", "Std.Dev", "Diff in mean", "p.value")) %>%
kable_styling(latex_options = c("hold_position", "scale_down")) %>%
add_header_above(c(" ", "Above median" = 2, "Below median" = 2, " ", " ")) %>%
add_header_above(c(" ", "Corporatism score" = 4, " ", " ")) %>%
save_kable(here("06 Figures and tables", "Tables", "balance_table_motivation.tex"))
### use kableExtra to create a table
balance_df %>%
kable(format = "latex",
escape = T,
booktabs = T,
caption = "Balance table: Comparison of variables above and below the median corporatism score",
label = "appendix-balance-table-motivation",
col.names = c("Variable", "Mean", "Std.Dev.", "Mean", "Std.Dev", "Diff in means", "p.value")) %>%
kable_styling(latex_options = c("hold_position", "scale_down")) %>%
add_header_above(c(" ", "Above median" = 2, "Below median" = 2, " ", " ")) %>%
add_header_above(c(" ", "Corporatism score" = 4, " ", " ")) %>%
save_kable(here("06 Figures and tables", "Tables", "balance_table_motivation.tex"))
str_balance_df_1 <- corp_str1_1 %>%
select("Stringency" = obs_value1_cy,
corp_all_group,
"Manufacturing value added (% of GDP)" = nv_ind_manf_zs,
"Industry value added (% of GDP)" = nv_ind_totl_zs,
"CO2 emissions per capita" = co2_per_capita,
"Fossil share electricity" = fossil_share_elec,
"Fossil share energy" = fossil_share_energy,
"Trade CO2 share" = trade_co2_share,
"Openness of economy" = openc,
"Gallagher's disproportionality index" = dis_gall) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "dataframe",
data = .)
View(str_balance_df_1)
corp_str1_1 %>%
select("Stringency" = obs_value1_cy,
corp_all_group,
"Manufacturing value added (% of GDP)" = nv_ind_manf_zs,
"Industry value added (% of GDP)" = nv_ind_totl_zs,
"CO2 emissions per capita" = co2_per_capita,
"Fossil share electricity" = fossil_share_elec,
"Fossil share energy" = fossil_share_energy,
"Trade CO2 share" = trade_co2_share,
"Openness of economy" = openc,
"Gallagher's disproportionality index" = dis_gall) %>%
modelsummary::datasummary_balance(~corp_all_group,
dinm_statistic = "p.value", output = "latex",
data = .)
### use kableExtra to create a table
balance_df %>%
kable(format = "latex",
escape = T,
booktabs = T,
caption = "Balance table: Comparison of variables above and below the median corporatism score",
label = "appendix-balance-table-motivation",
col.names = c("Variable", "Mean", "Std.Dev.", "Mean", "Std.Dev", "Diff in means", "p.value")) %>%
kable_styling(latex_options = c("hold_position", "scale_down")) %>%
row_spec(0, bold = T) %>%
add_header_above(c(" ", "Above median" = 2, "Below median" = 2, " ", " ")) %>%
add_header_above(c(" ", "Corporatism score" = 4, " ", " ")) %>%
save_kable(here("06 Figures and tables", "Tables", "balance_table_motivation.tex"))
### use kableExtra to create a table
balance_df %>%
kable(format = "latex",
escape = T,
booktabs = T,
caption = "Balance table for Figure \ref{fig:intro-motivation-figure} by corporatism grouping",
label = "appendix-balance-table-motivation",
col.names = c("Variable", "Mean", "Std.Dev.", "Mean", "Std.Dev", "Diff in means", "p.value")) %>%
kable_styling(latex_options = c("hold_position", "scale_down")) %>%
row_spec(0, bold = T) %>%
add_header_above(c(" ", "Above median" = 2, "Below median" = 2, " ", " ")) %>%
add_header_above(c(" ", "Corporatism score" = 4, " ", " ")) %>%
save_kable(here("06 Figures and tables", "Tables", "balance_table_motivation.tex"))
################################
# Preliminaries
################################
# Load packages
library(tidyverse)  # includes dplyr, ggplot2, tidyr, readr, purrr, tibble, stringr, forcats
library(readxl)     # For reading Excel files
library(scales)    # For formatting numbers and dates
library(arrow)      # Efficient data reading and writing
library(janitor)    # For clean_names()
library(here)       # For constructing paths
library(kableExtra) # For enhanced table output
library(patchwork)  # For combining plots
library(haven)     # For reading Stata files
# Set up path
data_folder <- list.files(file.path(here("03 Cleaned data", "OECD CAPMF")), full.names = TRUE)
# import data
oecd_overall <- readRDS(paste0(data_folder[grepl("Overall", data_folder)], "/oecd_merged.rds"))
oecd_adoption1 <- readRDS(paste0(data_folder[grepl("Adopt", data_folder)], "/oecd_adoption_LEV1.rds"))
oecd_adoption2 <- readRDS(paste0(data_folder[grepl("Adopt", data_folder)], "/oecd_adoption_LEV2.rds"))
oecd_stringency1 <- readRDS(paste0(data_folder[grepl("Stringency", data_folder)], "/oecd_stringency_LEV1.rds"))
oecd_stringency2 <- readRDS(paste0(data_folder[grepl("Stringency", data_folder)], "/oecd_stringency_LEV2.rds"))
oecd_stringency3 <- readRDS(paste0(data_folder[grepl("Stringency", data_folder)], "/oecd_stringency_LEV3.rds"))
oecd_stringency4 <- readRDS(paste0(data_folder[grepl("Stringency", data_folder)], "/oecd_stringency_LEV4.rds"))
### adoption data
corp_adopt1 <- oecd_adoption1 %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median")) %>%
group_by(time_period, corp_all_group) %>%
summarise(mean_policy_adopt = mean(obs_value1, na.rm = T)) %>%
ungroup()
View(corp_adopt1)
nlevels(factor(oecd_adoption1$reference_area))
View(corp_adopt1)
View(oecd_adoption1)
oecd_adoption1 %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median")) %>%
View()
oecd_adoption1 %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median")) %>%
distinct(ref_area, time_period)
oecd_adoption1 %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median")) %>%
distinct(reference_area, time_period) %>% View()
oecd_adoption1 %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median")) %>%
distinct(reference_area) %>% View()
oecd_adoption1 %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median")) %>%
distinct(reference_area) %>%
print()
oecd_adoption1 %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median")) %>%
distinct(reference_area) %>%
paste(., collapse = ", ")
### adoption data
corp_adopt1 <- oecd_adoption1 %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median")) %>%
group_by(time_period, corp_all_group) %>%
summarise(mean_policy_adopt = mean(obs_value1, na.rm = T)) %>%
ungroup()
### stringency data
corp_str1 <- oecd_stringency1 %>%
filter(!ref_area %in% c("USA", "BRA"),
!is.na(reference_area),
!is.na(corp_all)) %>%
group_by(time_period) %>%
mutate(median_corp_all = median(corp_all, na.rm = T)) %>%
ungroup() %>%
mutate(corp_all_group = ifelse(corp_all > median_corp_all, "Above median", "Below median")) %>%
group_by(time_period, corp_all_group) %>%
summarise(mean_stringency = mean(obs_value1, na.rm = T)) %>%
ungroup()
## bind together
corp_all1 <- bind_cols(corp_adopt1, corp_str1) %>%
clean_names() %>%
select(-c(time_period_4, corp_all_group_5)) %>%
rename(time_period = time_period_1,
corp_all_group = corp_all_group_2) %>%
pivot_longer(cols = c(mean_policy_adopt, mean_stringency),
names_to = "indicator",
values_to = "value")
## plot
corp_all1 %>%
ggplot(aes(x = time_period, y = value, colour = corp_all_group)) +
geom_line(linewidth = 1) +
facet_wrap(~indicator,
labeller = labeller(indicator = c("mean_policy_adopt" = "Mean number of adopted policies",
"mean_stringency" = "Mean stringency of policies")),
scales = "free_y") +
scale_colour_brewer("Corporatism score", palette = "Set1") +
scale_x_continuous("Year", breaks = seq(1990, 2020, 5)) +
expand_limits(y = 0) +
labs(y = "",
title = "Adoption and stringency of climate policies by corporatism grouping, 1990 - 2018") +
theme_bw() +
theme(legend.text = element_text(size = 10),
axis.title = element_text(size = 9),
strip.background = element_blank(),
plot.title = element_text(size = 13, hjust = 0.5),
strip.text.x = element_text(size = 10),
legend.position = "bottom")
## plot
corp_all1 %>%
ggplot(aes(x = time_period, y = value, colour = corp_all_group)) +
geom_line(linewidth = 1) +
facet_wrap(~indicator,
labeller = labeller(indicator = c("mean_policy_adopt" = "Mean number of adopted policies",
"mean_stringency" = "Mean stringency of policies")),
scales = "free_y") +
scale_colour_brewer("Corporatism score", palette = "Set1") +
scale_x_continuous("Year", breaks = seq(1990, 2020, 5)) +
expand_limits(y = 0) +
labs(y = "",
title = "Adoption and stringency of climate policies by corporatism grouping, 1990 - 2018") +
theme_bw() +
theme(legend.text = element_text(size = 10),
axis.title = element_text(size = 9),
strip.background = element_blank(),
plot.title = element_text(size = 13, hjust = 0.5),
strip.text.x = element_text(size = 10),
legend.position = "bottom")
## save plot
ggsave(here("06 Figures and tables", "Figures", "corp_all_climate.png"),
width = 9, height = 6, dpi = 300)
